import { isBrowser, isDev } from 'config';
import { applyMiddleware, compose, createStore } from 'redux';
import createSagaMiddleware from 'redux-saga';

import rootReducer from './reducer';
import sagas from './sagas';

var devtools = isDev && isBrowser && window.devToolsExtension ? window.devToolsExtension : function () {
  return function (fn) {
    return fn;
  };
};

var configureStore = function configureStore(initialState) {
  var services = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  var sagaMiddleware = createSagaMiddleware();

  var enhancers = [applyMiddleware(sagaMiddleware), devtools()];

  var store = createStore(rootReducer, initialState, compose.apply(undefined, enhancers));

  var sagaTask = sagaMiddleware.run(sagas, services);

  if (module.hot) {
    module.hot.accept('./reducer', function () {
      var nextReducer = require('./reducer').default;
      store.replaceReducer(nextReducer);
    });
    module.hot.accept('./sagas', function () {
      var nextSagas = require('./sagas').default;
      sagaTask.cancel();
      sagaTask.done.then(function () {
        sagaTask = sagaMiddleware.run(nextSagas, services);
      });
    });
  }

  return store;
};

var _default = configureStore;
export default _default;
;

var _temp = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(devtools, 'devtools', '/home/ryan/dev/port/src/store/configure.js');

  __REACT_HOT_LOADER__.register(configureStore, 'configureStore', '/home/ryan/dev/port/src/store/configure.js');

  __REACT_HOT_LOADER__.register(_default, 'default', '/home/ryan/dev/port/src/store/configure.js');
}();

;